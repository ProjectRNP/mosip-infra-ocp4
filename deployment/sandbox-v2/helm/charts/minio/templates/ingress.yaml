# We have written a separate ingress for keycloak 'cause it requires
# a different rewrite rule.  We want keycloak url to be 
# https://public_server/keycloak/auth/, rather than
# https://public_server/auth/.  Not that last slash is important!

apiVersion: networking.k8s.io/v1beta1
kind: Ingress
metadata:
  name: minio
  namespace: {{ .Release.Namespace }}
  annotations:
    ingress.kubernetes.io/class: nginx
spec:
  rules:
  - http:
      paths:
      - path: /minio  # To browser
        backend:
          serviceName: {{ template "minio.fullname" . }}
          servicePort: {{ .Values.service.port }} 

apiVersion: route.openshift.io/v1
kind: Route
metadata:
  annotations:
    description: Route for application's https service.
  labels:
    application: {{ template "minio.fullname" . }}
  name: minio
  namespace: {{ .Release.Namespace }}
spec:
  host: "activemq.{{ .Values.domain}}"
  port:
    targetPort: {{ .Values.service.port }}
  #tls:
  #  termination: passthrough
  to:
    kind: Service
    name: {{ template "minio.fullname" . }}

